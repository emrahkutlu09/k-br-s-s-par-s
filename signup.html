<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Kayıt Ol</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 30px; }
    form { background: white; padding: 20px; border-radius: 8px; max-width: 400px; margin: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    input { display: block; width: 100%; margin-bottom: 10px; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
    button { padding: 10px 15px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #218838; }
  </style>
</head>
<body>
  <h2 style="text-align:center;">Kayıt Ol</h2>
  <form id="kayitFormu">
    <input type="text" id="adSoyad" placeholder="Ad Soyad" required>
    <input type="email" id="email" placeholder="E-posta">
    <input type="password" id="sifre" placeholder="Şifre" required>
    <input type="tel" id="telefon" placeholder="Telefon Numarası" required>
    <input type="text" id="adres" placeholder="Adres" required>
    <button type="submit">Kayıt Ol</button>
  </form>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBCbKtD6jPE653IYwtTWo2fH93JXX4MN74",
      authDomain: "kibrissiparissistemi.firebaseapp.com",
      projectId: "kibrissiparissistemi",
      storageBucket: "kibrissiparissistemi.appspot.com",
      messagingSenderId: "263531733235",
      appId: "1:263531733235:web:82efdf39ed758a22465786"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    document.getElementById("kayitFormu").addEventListener("submit", async function(e) {
      e.preventDefault();

      const adSoyad = document.getElementById("adSoyad").value;
      const email = document.getElementById("email").value;
      const sifre = document.getElementById("sifre").value;
      const telefon = document.getElementById("telefon").value;
      const adres = document.getElementById("adres").value;

      try {
        let kullanici;

        if (email && sifre) {
          const sonuc = await auth.createUserWithEmailAndPassword(email, sifre);
          kullanici = sonuc.user;
        } else {
          // E-posta girilmemişse sahte UID ile kayıt
          kullanici = { uid: "uid_" + Date.now() };
        }

        await db.collection("uyeler").doc(kullanici.uid).set({
          adSoyad,
          email,
          telefon,
          adres,
          kayitTarihi: new Date()
        });

        alert("Kayıt başarılı!");
        window.location.href = "confirm.html";
      } catch (error) {
        alert("Hata: " + error.message);
      }
    });
  </script>
</body>
</html>
