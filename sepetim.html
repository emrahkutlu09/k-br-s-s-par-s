<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Sepetim</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2; padding: 30px; }
    h2 { text-align: center; }
    .siparis-kart {
      background: white;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .siparis-kart p { margin: 6px 0; }
  </style>
</head>
<body>
  <h2>ğŸ›’ SipariÅŸlerim</h2>
  <div id="siparisListesi"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBCbKtD6jPE653IYwtTWo2fH93JXX4MN74",
      authDomain: "kibrissiparissistemi.firebaseapp.com",
      projectId: "kibrissiparissistemi",
      storageBucket: "kibrissiparissistemi.appspot.com",
      messagingSenderId: "263531733235",
      appId: "1:263531733235:web:82efdf39ed758a22465786"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();
    const liste = document.getElementById("siparisListesi");

    auth.onAuthStateChanged(user => {
      if (!user) {
        window.location.href = "giris.html";
        return;
      }

      db.collection("siparisler")
        .where("kullaniciId", "==", user.uid)
        .orderBy("zaman", "desc")
        .get()
        .then(snapshot => {
          if (snapshot.empty) {
            liste.innerHTML = "<p>HenÃ¼z bir sipariÅŸiniz yok.</p>";
            return;
          }

          snapshot.forEach(doc => {
            const s = doc.data();
            const kart = document.createElement("div");
            kart.className = "siparis-kart";
            const zaman = s.zaman.toDate().toLocaleString("tr-TR");
            kart.innerHTML = `
              <p><strong>ğŸ“¦ SipariÅŸ Kodu:</strong> ${s.siparisKodu || "-"}</p>
              <p><strong>ğŸ’° Fiyat:</strong> ${s.fiyat} â‚º</p>
              <p><strong>ğŸ“‚ Kategori:</strong> ${s.kategori}</p>
              <p><strong>ğŸšš Teslimat:</strong> ${s.teslimat}</p>
              <p><strong>ğŸ“Œ Durum:</strong> ${s.durum || "HazÄ±rlanÄ±yor"}</p>
              <p><strong>ğŸ•’ Tarih:</strong> ${zaman}</p>
            `;
            liste.appendChild(kart);
          });
        });
    });
  </script>
</body>
</html>
