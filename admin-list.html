<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“‹ SipariÅŸ YÃ¶netim Paneli</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .siparis-kart {
      background: white;
      border-left: 5px solid #007bff;
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .siparis-kart p {
      margin: 6px 0;
    }
    .durum-buttons button {
      margin-right: 5px;
      padding: 5px 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .hazirla { background-color: orange; color: white; }
    .kargoda { background-color: dodgerblue; color: white; }
    .teslim { background-color: seagreen; color: white; }
    .sil { background-color: red; color: white; }
  </style>
</head>
<body>
  <script>
    if (localStorage.getItem("girisYapildi") !== "true") {
      window.location.href = "admin-login.html";
    }
  </script>

  <h2>ğŸ“‹ SipariÅŸ YÃ¶netim Paneli</h2>
  <div id="siparisAlani"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBCbKtD6jPE653IYwtTWo2fH93JXX4MN74",
      authDomain: "kibrissiparissistemi.firebaseapp.com",
      projectId: "kibrissiparissistemi",
      storageBucket: "kibrissiparissistemi.firebasestorage.app",
      messagingSenderId: "263531733235",
      appId: "1:263531733235:web:82efdf39ed758a22465786",
      measurementId: "G-JK5S6L90Q5"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const alan = document.getElementById("siparisAlani");

    db.collection("siparisler").onSnapshot(snapshot => {
      alan.innerHTML = "";
      snapshot.forEach(doc => {
        const data = doc.data();
        const div = document.createElement("div");
        div.className = "siparis-kart";

        div.innerHTML = `
          <p>ğŸ“¦ <strong>ÃœrÃ¼n Linki:</strong> <a href="${data.urunLink}" target="_blank">${data.urunLink}</a></p>
          <p>ğŸ’° <strong>Fiyat:</strong> ${data.ucret} â‚º</p>
          <p>ğŸ“ <strong>Kategori:</strong> ${data.kategori}</p>
          <p>ğŸšš <strong>Teslimat:</strong> ${data.teslimat}</p>
          <p>ğŸ§¾ <strong>Toplam:</strong> ${data.toplam} â‚º</p>
          <p>ğŸ“… <strong>Tarih:</strong> ${data.tarih}</p>
          <p>ğŸ“ <strong>Durum:</strong> ${data.durum}</p>
          <div class="durum-buttons">
            <button class="hazirla" onclick="guncelleDurum('${doc.id}', 'HazÄ±rlanÄ±yor')">HazÄ±rlanÄ±yor</button>
            <button class="kargoda" onclick="guncelleDurum('${doc.id}', 'Kargoda')">Kargoda</button>
            <button class="teslim" onclick="guncelleDurum('${doc.id}', 'Teslim Edildi')">Teslim Edildi</button>
            <button class="sil" onclick="silSiparis('${doc.id}')">ğŸ—‘ Sil</button>
          </div>
        `;

        alan.appendChild(div);
      });
    });

    function guncelleDurum(id, yeniDurum) {
      db.collection("siparisler").doc(id).update({ durum: yeniDurum });
    }

    function silSiparis(id) {
      if (confirm("Bu sipariÅŸi silmek istediÄŸinize emin misiniz?")) {
        db.collection("siparisler").doc(id).delete();
      }
    }
  </script>
</body>
</html>
